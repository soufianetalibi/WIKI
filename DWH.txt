
Extraction -> DonnÃ©es brutes
Transformation -> DonnÃ©es nettoyÃ©es, structurÃ©es
Chargement DonnÃ©es -> envoyer vers un DWH

ETL (Extract, Transform, Load) permet de faire les 3 Ã©tapes.

=== Exemple pratique : 

-PrÃ©parer les donnÃ©es sources sur la table "Commandes" 
-CrÃ©er les tables de dimensions (modÃ©lisation)
-CrÃ©er la table de faits "FaitCommandes" et y insÃ©rer les donnÃ©es de Commandes transformÃ©es
-Lancer des requÃªtes analytiques


==============ðŸ“¥les donnÃ©es sources
CREATE TABLE Commandes (
    IdCommande INT,
    DateCommande DATE,
    IdClient INT,
    IdProduit INT,
    Quantite INT,
    Montant DECIMAL(10,2)
);

=============ðŸ§­ CrÃ©er les tables de dimensions
-- Dimension Client
CREATE TABLE DimClient (
    IdClient INT PRIMARY KEY,
    NomClient NVARCHAR(100),
    Region NVARCHAR(50),
    Segment NVARCHAR(50)
);

-- Dimension Produit
CREATE TABLE DimProduit (
    IdProduit INT PRIMARY KEY,
    NomProduit NVARCHAR(100),
    Categorie NVARCHAR(50),
    Marque NVARCHAR(50)
);

-- Dimension Date
CREATE TABLE DimDate (
    DateKey DATE PRIMARY KEY,
    Jour INT,
    Mois INT,
    Trimestre INT,
    Annee INT
);


================ðŸ“Š CrÃ©er la table de faits
CREATE TABLE FaitCommandes (
    IdCommande INT PRIMARY KEY,
    DateKey DATE FOREIGN KEY REFERENCES DimDate(DateKey),
    IdClient INT FOREIGN KEY REFERENCES DimClient(IdClient),
    IdProduit INT FOREIGN KEY REFERENCES DimProduit(IdProduit),
    Quantite INT,
    Montant DECIMAL(10,2)
);

=================

Clients : 1, 2, 3

Produits : 101 Ã  104

Dates : rÃ©parties sur 2023, 2024, 2025

==========================================================================================
insÃ©rer les donnÃ©es de Commandes transformÃ©es : 

INSERT INTO FaitCommandes (IdCommande, DateKey, IdClient, IdProduit, Quantite, Montant)
SELECT 
    c.IdCommande,
    c.DateCommande,
    c.IdClient,
    c.IdProduit,
    c.Quantite,
    c.Montant
FROM Commandes c
JOIN DimDate d ON c.DateCommande = d.DateKey
JOIN DimClient cl ON c.IdClient = cl.IdClient
JOIN DimProduit p ON c.IdProduit = p.IdProduit;

==========================================================================================
RequÃªte analytique sur la table "FaitCommandes"  :
==============================
SELECT 
    d.Annee,
    p.Categorie,
    SUM(f.Montant) AS TotalVentes
FROM FaitCommandes f
JOIN DimDate d ON f.DateKey = d.DateKey
JOIN DimProduit p ON f.IdProduit = p.IdProduit
GROUP BY d.Annee, p.Categorie;

=>Ã§a va donner le total des ventes par catÃ©gories de produits par annÃ©e  : 

Annee	Categorie	TotalVentes
2023	Ã‰lectronique	1â€¯250â€¯000
2023	VÃªtements	980â€¯000
2024	Ã‰lectronique	1â€¯450â€¯000
2024	VÃªtements	1â€¯100â€¯000
===================================================