we associate locks with subscription, resource group or ressources

two types of locks : 
 read only lock, prevent any change on the object.
 delete locks, prevent deletion

when moving ressources, both source group and target group are locked.

we can move to a resource group, subscription or region.

onglet "usage + quotas" : the resource limits of you subscription fixed by azure (you can increase it by creating a support request).

Ã‰lÃ©ments du template ARM : 
schema	Une section obligatoire qui dÃ©finit lâ€™emplacement du fichier du schÃ©ma JSON qui dÃ©crit la structure des donnÃ©es JSON. Le numÃ©ro de version que vous utilisez dÃ©pend de lâ€™Ã©tendue du dÃ©ploiement et de votre Ã©diteur JSON.
contentVersion	Une section obligatoire qui dÃ©finit la version de votre modÃ¨le (par exemple 1.0.0.0). Vous pouvez utiliser cette valeur pour documenter les modifications importantes apportÃ©es Ã  votre modÃ¨le pour Ãªtre sÃ»r de dÃ©ployer le modÃ¨le appropriÃ©.
apiProfile	Une section facultative qui dÃ©finit une collection de versions dâ€™API pour les types de ressources. Vous pouvez utiliser cette valeur pour Ã©viter dâ€™avoir Ã  spÃ©cifier les versions dâ€™API pour chaque ressource dans le modÃ¨le.
parameters	Une section facultative oÃ¹ vous dÃ©finissez des valeurs fournies lors du dÃ©ploiement. Ces valeurs peuvent Ãªtre fournies par un fichier de paramÃ¨tres, par des paramÃ¨tres de ligne de commande ou dans le portail Azure.
variables	Une section facultative oÃ¹ vous dÃ©finissez des valeurs utilisÃ©es pour simplifier les expressions de langage de gabarit.
functions	Une section facultative oÃ¹ vous pouvez dÃ©finir des fonctions dÃ©finies par lâ€™utilisateur qui sont disponibles dans le modÃ¨le. Les fonctions dÃ©finies par lâ€™utilisateur peuvent simplifier votre modÃ¨le quand des expressions compliquÃ©es y sont utilisÃ©es de faÃ§on rÃ©pÃ©tÃ©e.
resources	Une section obligatoire qui dÃ©finit les Ã©lÃ©ments rÃ©els que vous voulez dÃ©ployer ou mettre Ã  jour dans un groupe de ressources ou un abonnement.
output	Une section facultative oÃ¹ vous spÃ©cifiez les valeurs qui seront retournÃ©es Ã  la fin du dÃ©ploiement.

PowerShell 7.0.6 LTS, PowerShell 7.1.3, or higher is the recommended version of PowerShell for use with the Azure Az PowerShell module

version powershell : $PSVersionTable.PSVersion

Check des modules PowerShell : Get-Module

Install module azure : 
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

Install-Module -Name Az -Scope CurrentUser -Repository PSGallery

Connect-AzAccount
Get-AzContext cmdlet to determine which subscription is active
Get-AzResourceGroup 
Get-AzResource


AccÃ©dez Ã  votre dossier de base dans Cloud Shell.
cd $HOME\clouddrive

CrÃ©ez un fichier texte nommÃ© ConferenceDailyReset.ps1.
touch "./ConferenceDailyReset.ps1"

Ouvrez lâ€™Ã©diteur intÃ©grÃ©, puis sÃ©lectionnez le fichier ConferenceDailyReset.ps1.
code "./ConferenceDailyReset.ps1"

y mettre le contenu suivant : 

param([string]$resourceGroup)
$adminCredential = Get-Credential -Message "Enter a username and password for the VM administrator."
For ($i = 1; $i -le 3; $i++)
{
    $vmName = "ConferenceDemo" + $i
    Write-Host "Creating VM: " $vmName
    New-AzVm -ResourceGroupName $resourceGroup -Name $vmName -Credential $adminCredential -Image UbuntuLTS
}

executer avec : ./ConferenceDailyReset.ps1 learn-3305ecf6-78b1-46c2-82a3-0927dfe60c85

NSGs has Ã  priority : a number between 100 and 4096. Rules are processed in priority order, with lower numbers processed before higher numbers, 

Azure creates the default rules in each network security group that you create. 

We add azure CLI via the install of an msi
Login on CLI : az login
parameter can you add to most CLI commands to get concise, formatted output : "table"
az group list --output table

We can user PowerShell, Azure CLI or the Azure portal from windows Linux or Mac. 

-CrÃ©er une webapp : 
create a service plan
Create Ã  Web app oh this service plan 

URL : http://webapp-mslearn123.azurewebsites.net

->deploy code from a GitHub repository to the web app (PHP code for example to modifier the content of my website) 
az webapp deployment source config --name $AZURE_WEB_APP --resource-group $RESOURCE_GROUP --repo-url "https://github.com/Azure-Samples/php-docs-hello-world" --branch master --manual-integration

======= Les accÃ¨s azure : rÃ´les classiques, RBAC et azure AD : 


gÃ©rer azure via le portail Azure ou via les API Azure ARM et ASM

-Les rÃ´les Azure historiques Â« Classiques Â»  (azure ASM)
    Administrateur de compte (Account Administrator)
    Administrateur de Service (Service Administrator)
    Co-Administrateur (Co-Administrator)

  --> avec ce modÃ¨le classique vous avez tout ou rien (All-or-Nothing), pas possible de dÃ©lÃ©guer par exemple la gestion des VMs Ã  un groupe ...
  --> on applique les rÃ´les classiques sur un abonnement, un groupe de ressource ou une ressource sur IAM / Administrateurs classiques

-Les rÃ´les Â« RBAC Â»  : 
 
  les rÃ´les Azure RBAC sont dÃ©diÃ©s Ã  lâ€™accÃ¨s et gestion des ressources Azure uniquement telles que les VMs Azure, Bases de donnÃ©es SQL Clusters HDI, Services RÃ©seaux (VNET, Subnet, Gateway VPN, NSG, LBâ€¦)
    --> on applique les rÃ´les RBAC sur un abonnement, un groupe de ressource ou une ressource sur IAM / ajouter une attribution de rÃ´le

  les 4 rÃ´les RBAC les plus importants du RBAC qui s'appliquent sur un abonnement, un groupe de ressource ou une ressource : 
 
    PropriÃ©taire (Owner) : accÃ¨s Ã  la ressource et permet l'accÃ¨s Ã  d'autres personnes.
    Contributeur (Contributeur) : AccÃ¨s Ã  la ressource mais ne peut pas ajouter d'autres personnes
    Lecteur (Reader) : lecture seule
    Administrateur de lâ€™accÃ¨s utilisateur (User Access Administrator) : Gestion de lâ€™accÃ¨s utilisateur aux ressources Azure
  
  en plus de ces 4 rÃ´les, il existent d'autres rÃ´les plus prÃ©cis, par ex : Azure VM Contributor

   si je donne Ã  un user le rÃ´le contributeur sur un abonnement, il va gÃ©rer l'ensemble des ressources dans cet abonnnement 
   si je donne Ã  un user le rÃ´le Azure VM Contributor sur un abonnement, il va gÃ©rer uniquement les VMs de cet abonnement 
   si je donne Ã  un user le rÃ´le lecteur sur la ressource azure AD, il va accÃ©der Ã  azure AD uniquement et afficher les utilisateurs, les groupes ... 

On peut crÃ©er un rÃ´le personnalisÃ© : 
 Un Custom Role est crÃ©Ã© sur la base dâ€™un fichier JSON, exemple : 
     crÃ©er un Custom Role permettant uniquement le dÃ©marrage, arrÃªt et redÃ©marrage des VMs Azure.

-Les rÃ´les Azure AD : presque 56 rÃ´les azure AD
 
 utilisÃ©s pour gÃ©rer les ressources de lâ€™annuaire Azure AD, exemple : 
     --crÃ©er ou modifier des comptes utilisateurs Azure
     --attribuer des rÃ´les dâ€™administration Ã  dâ€™autres personnes
     --gÃ©rer lâ€™appartenance aux groupes Azure AD
     --rÃ©initialiser les mots de passe des utilisateurs

     Les 3 rÃ´les principaux d'azure AD : 
   
      -Administrateur gÃ©nÃ©ral (Global Administrator) : 
      -Administrateur dâ€™utilisateurs (Users Administrator) : 
      -Administrateur de facturation (Billing Administrator) : 

     pour gÃ©rer les rÃ´les azure AD : Azure active directory / RÃ´les et Administrateurs

azure AD est par dÃ©faut Free Trial 
pour utiliser azure AD P2, aller sur licenses, activer premium P2 (pour utiliser les groupes dynamiques ...)


===============================

-crÃ©er un abonnement avec mon email, je serai automatiquement Account Administrator et Service Administrator
-je peux dÃ©clarer des coadministrateurs au niveau IAM / Administrateurs classiques.

Les Administrateurs de Services et les Co-administrateurs sont Ã©quivalents au rÃ´le Â« Owner /PropriÃ©taire Â» du nouveau modÃ¨le RBAC (Azure ARM) et offrent un accÃ¨s total au niveau de lâ€™abonnement

=====


=====
AZ 104

 ğŸ”¹ Manage Azure Entra ID Identities
 ğŸ§ª https://lnkd.in/diDaDxjX
 ğŸ”¹ Manage Subscriptions and RBAC
 ğŸ§ª https://lnkd.in/dmuqpxUJ
 ğŸ”¹ Manage Governance via Azure Policy
 ğŸ§ª https://lnkd.in/di3iBw6h
 ğŸ”¹ Manage Azure Resources by using the Azure Portal
 ğŸ§ª https://lnkd.in/d9V2h2xd
 ğŸ”¹ Manage Azure resources by using Azure Resource Manage Templates
 ğŸ§ª https://lnkd.in/dGnVX6dM
 ğŸ”¹ Manage Azure Resources by using Azure PowerShell
 ğŸ§ª https://lnkd.in/dGS_V9St
 ğŸ”¹ Manage Azure resources by using the Azure CLI
 ğŸ§ª https://lnkd.in/dqvrkGhY
 ğŸ”¹ Implement Virtual networking
 ğŸ§ª https://lnkd.in/d6yejKdB
 ğŸ”¹ Implement intersite Connectivity
 ğŸ§ª https://lnkd.in/dCGARJFp
 ğŸ”¹ Implement Traffic management
 ğŸ§ª https://lnkd.in/dWJDZ4HD
 ğŸ”¹ Manage Azure Storage
 ğŸ§ª https://lnkd.in/dbmGjkTi
 ğŸ”¹ Manage Virtual Machines
 ğŸ§ª https://lnkd.in/drk6_WPK
 ğŸ”¹ Implement Azure Web apps
 ğŸ§ª https://lnkd.in/dhGefkn9
 ğŸ”¹ Implement Azure Container Instances
 ğŸ§ª https://lnkd.in/dHn4dmaK
 ğŸ”¹ Implement Azure Kubernetes Service
 ğŸ§ª https://lnkd.in/dQQ6s5dp
 ğŸ”¹ Backup Virtual Machines
 ğŸ§ª https://lnkd.in/dx6VzgsU
 ğŸ”¹ Implement Monitoring
 ğŸ§ª https://lnkd.in/dTGeM6fU
















