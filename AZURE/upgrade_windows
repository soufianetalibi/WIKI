Mettre à jour d'abord : Drivers et firmware du matériel : 

Outils qui scannent l’inventaire matériel et proposent les firmware et drivers certifiés pour un OS que je veux installer : 
https://www.dell.com/support/home/fr-fr/products
https://support.hpe.com/connect/s/?language=fr
https://support.lenovo.com/ma/en/

# voir tous les périphériques avec un driver signé installé sur Windows : 
Get-WmiObject Win32_PnPSignedDriver | Select DeviceName, DriverVersion, Manufacturer

# Vérifier la version BIOS/UEFI
Get-WmiObject Win32_BIOS | Select Manufacturer, Name, SMBIOSBIOSVersion, ReleaseDate

# Nic ou stockage
Get-PnpDevice -Class Net | Select FriendlyName, Status, DriverVersion

si c'est une VM, l'hyperviseur gère le BIOS virtuel, il suffit d'installer les VMtools à la dernière version

Upgrade via image.ISO et powershell : 

# Exemple : monter l'ISO sur la VM
$isoPath = "\\ServeurNAS\ISOs\WindowsServer2022.iso"
Mount-DiskImage -ImagePath $isoPath

Une fois monté, le lecteur ISO apparaît, par exemple D:\

$setupPath = "D:\setup.exe"
Start-Process -FilePath $setupPath -ArgumentList "/auto upgrade /quiet /noreboot /DynamicUpdate enable /Compat IgnoreWarning" -Wait

Après l’upgrade, tu peux redémarrer la VM via :
Restart-Computer -Force

======pour boucler sur des VMs : 

$VMs = @("VM2019-01", "VM2019-02", "VM2019-03") 

foreach ($vm in $VMs) {
    Invoke-Command -VMName $vm -ScriptBlock {
        $setupPath = "D:\setup.exe"
        Start-Process -FilePath $setupPath -ArgumentList "/auto upgrade /quiet /noreboot /DynamicUpdate enable /Compat IgnoreWarning" -Wait
        Restart-Computer -Force
    }
}

====Vérification après upgrade
# Vérifier la version installée
Get-ComputerInfo | Select WindowsProductName, WindowsVersion, OsBuildNumber
